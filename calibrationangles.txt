 1 New Calibration and Computing Method for Direct Georeferencing of Image and Scanner Data Using the Position and Angular Data of an Hybrid Inertial Navigation System  by  M. Bäumker and F.J. Heimes FH Bochum University of Applied Sciences  e-mails: manfred.baeumker@fh-bochum.de franz-josef.heimes@fh-bochum.de    Abstract The direct georeferencing of images or other photogrammetric data requires accurate angles and positions of the site of the expose. Recently these data will be measured by an inertial reference system augmented by a GPS sensor. While the definitions of the angles derived by the inertial reference system differ from those needed for the georeferencing, appropriate transformation formulas are evident. These formulas also have to consider the small misalignments between the image coordinate system and the body coordinate system established by the inertial instruments. The new transformation algorithms in respect to these misalignments as well as a new method to calibrate the misalignments are described.    1 Introduction Direct georeferencing of image-, video- and scanner data by means of GPS-augmented inertial systems is of growing importance for photogrammetric applications (Schwarz 1995, Hutton et al. 1998, Cramer 1999). Special attention and considerations have to be focussed to the angular data determined by inertial reference systems which are defined according to the aviation standard ARINC 705 [Airlines Electronic Engineering Committe 1982] and to their transformation into the individual  photogrammetric system used.  Today’s state-of-the-art inertial reference systems are either based on laser gyros or on fibre optical gyros in a so-called strapdown configuration in which the inertial sensors (normally three gyros and three accelerometers) are fixed in respect to a body coordinate system which normally coincides with the principal axes of the aircraft. The inertially determined heading and attitude data according to the aviation norm ARINC 705 as well as other navigational parameters are usually used for flight control, flight management purposes and for the transformations of the velocity increments determined in the body coordinate system into the navigation coordinate system (Bäumker 1995). The definition of these coordinate systems and their corresponding angles do not comply with the coordinate systems and angles (omega, phi and kappa) used in photogrammetry. Besides the different definitions, the axes of the body coordinate system and of the camera or image system have to be mounted parallel to each other. But in practice there still remains small angular discrepancies (± 1° or more) after their mounting. These so-called misalignments affect and limit the overall accuracy of the photogrammetric angles. The definition of the different coordinate systems as well as the definition of the different angles are presented in the paper. Furthermore the necessary transformations including the rigorous treatment of the misalignments are derived for some standard application cases in photogrammetry. Besides these fundamental aspects a new adjustment and calibration method to determine the misalignments has been worked out.    2  2 Fundamentels of the coordinate systems and angles used in inertial navigation Inertial navigation is based on the continuous integration of the accelerations measured by the accelerometers. In a strapdown configuration the accelerations are measured in a body fixed coordinate system (index b; axes: xb: along, positive forward, yb: across, positive to the right, zb: vertical, positive down). Besides the correction due to gravity and other effects the accelerations have to be transformed prior to its integration into a local level coordinate system – the so-called navigation coordinate system (index n; axes: xn: northward, yn: eastward, zn: vertical in direction of the plumb line). This transformation is performed by a rotation matrix which includes three rotations of the Euler angles according to ARINC 705 (heading: y, roll: f, pitch: q). The angles and rotation matrix have to be continuously updated by means of the gyro measurements and are used for flight control and other navigational or stabilisation purposes. Figure 1 shows the definitions of the coordinate systems and the corresponding Euler angles.   rollfpitchqyheadinghorizonNorthEasthorizonqfyright wing downnose upturn rightzbybxbxbyb  Figure 1: Definition of the body and the navigation coordinate systems and of the Euler angles f, q, y  The roll, pitch and heading angles are used to transform a vector from the body coordinate system into the navigation system or vice versa. The transformation matrix itself is calculated by three consecutive rotation matrices in the following order: 1st rotation: roll around x-axis; 2nd rotation: pitch around y-axis; 3rd rotation: heading (yaw) around z-axis. The combination of the three rotations results in the following orthogonal transformation matrix: Cbn=Rz(y)$Ry(h)$Rx(v)=cosy-siny0sinycosy0001$cosh0sinh010-sinh0cosh$1000cosv-sinv0sinvcosv  Cbn=cosy$coshcosy$sinh$sinv-siny$cosvcosy$sinh$cosv+siny$sinvsiny$coshsiny$sinh$sinv+cosy$cosvsiny$sinh$cosv-cosy$sinv-sinhcosh$sinvcosh$cosv    The inverse transformation (from the navigation coordinate system into the body coordinate system can be easily performed by: Cnb=(Cbn)-1=(Cbn)T  The notation used for the indices directly indicates the transformation direction: the lower index represents the original system and the upper index the target system. Example: If the origin of a camera or a GPS antenna are mounted at different sites a lever arm transformation is needed to transfer the position of the GPS antenna to the camera. As the lever arm rb is measured in the body  3 coordinate system a transformation into the navigation coordinate system rn has to be applied. This is done by: rn=Cbn$rb The inverse transformation is performed by:  rb=Cnb$rn=(Cbn)-1$rn  If the transformation matrix is known the Euler angles (roll f, pitch q, heading y) can be directly recalculated from its elements Cij (i = column, j = row):    v=arctanC32C33 h=arcsin-C31=arctan-C31C322+C332  y=arctanC21C11  As already mentioned the navigation coordinate system is related to the local level and the direction to the North. In case of a roving craft this coordinate system is not fixed but changes with respect to the velocity of the craft (see Figure 2).   Figure 2: Transport rate, earth rate, navigation coordinate system and its relation to the earth centred earth fixed coordinate (ECEF) system.              These changes are called transport rate  Wenn and its vector can be calculated by:  VN: north velocity VE: east velocity j, l, h: ellipsoidal geographic coordinates              (latitude, longitude, height) RN, RE: mean radii of the earth ellipsoid   The relation between the varying navigation systems and its axes orientations can be realised with the help of an earth centred earth fixed coordinate system (ECEF, Index e). This is performed by the following two rotation matrices containing the ellipsoidal geographic coordinates j, l:  Cen=Ry(w+90))$Rz(k)=cos(w+90))0sin(w+90))010-sin(w+90))0cos(w+90))$cosk-sink0-sinkcosk0001=   Wenn=*k$cosw-*w-*k$sinw=VERE+h-VNRN+h-VE$tanwRE+h=zenxnzenynzenznEWEarth rateZeXeYetransport  rateearth centred earth fixed coordinate system (e-System)Northplumb-navigationcoordinate system lineNorthplumb-navigationcoordinate system line 4 =-sinw0cosw010-cosw0-sinw$cosk-sink0-sinkcosk0001=-sinw$cosk-sinw$sinkcosw-sinkcosk0-cosw-cosw$sink-sinw  The result is a transformation matrix to transform a vector from the ECEF-System (e-system) to any navigation system (n-system) or vice versa: ECEF system à navigation system: rn=Cen$re=(Cne)T$re navigation system à ECEF system: re=Cne$rn=(Cen)-1$rn  All coordinate systems (b-system, n-system, e-system) are right handed three dimensional cartesian coordinate systems.    3 Fundamentels of the coordinate systems and angles used in photogrammetry The body coordinate system (b-System) used in inertial navigation seems to be similar to the image coordinate system (B-System) used in photogrammetry. The image coordinate system is realised by the  fiducial marks of the camera or the CCD sensor. The origin is the projection centre O in the distance of the focus length c to the principal point (see Figure 3). Instead of the navigation system (n-system) in photogrammetry the quite similar earth fixed terrain or object coordinate system (E-System) is used. Besides the different orientations of the coordinate systems the rotation angles (j, w, k) are defined in very different orders additionally depending on the photogrammetric mapping system.  Figure 3: Definitions of the coordinate systems and rotation angles used in photogrammetry: image coordinate system B, terrain or object coordinate system E, and rotation angles  j, w, k                A typical candidate of an object coordinate system is the Gauß-Krüger-coordinate system or an equivalent mapping system. But to avoid a left handed orientated coordinate system the x-axis is pointing eastward and the y-axis northward while the direction of the z-axis (height) is aligned to the zenith. Such mapping systems of the earth ellipsoid have a non unique scaling and nevertheless the H'P'projection beam to Pcxyzimage coordinate system Bprojection centre OP(x  ,y  ,z  )z  (H) (zenith)yxearth fixed object coordinate system EE    E   Ezyxkjwrotation anglesj, w, kEEEBBBNorth EastEEE 5 meridian deviation is affecting the orientation in respect to the geographic orientation. These difficulties can be avoided by using a spatial cartesian coordinate system tangent to the level surface.  The transformations needed are established for various photogrammetric bundle adjustment systems like BLUH developed at the university Hannover (Jacobsen 1996) and like PATB of the university Stuttgart (INPHO GmbH 1999) which have different definitions of the order of the rotation angles. Other orders are described in (Kraus 1997 a, b) to which the following transformation algorithms can be easily adopted if necessary. The definition of the rotation angles and its rotation order of the bundle adjustment systems mentioned above (BLUH, PATB) are as follows:  CEBLUHB=Rz(|)$Rx(z)$Ry(w)=cos|sin|0-sin|cos|0001$1000coszsinz0-sinzcosz$cosw0-sinw010sinw0cosw CEPATBB=Rx(z)$Ry(w)$Rz(|)=1000cosz-sinz0sinzcosz$cosw0sinw010-sinw0cosw$cos|-sin|0sinxcos|0001  The results of the matrix multiplication are:  CEBLUHB=cosj$cosw+sinj$sinz$sinwsinj$cosz-cosj$sinw+sinj$sinz$cosw-sinj$cosw+cosj$sinz$sinwcosj$coszsinj$sinw+cosj$sinz$coswcosz$sinw-sinzcosz$cosw  CEPATBB=cosw$cos|-cosw$sinjsinwcosz$sin|+sinz$sinw$cos|cosz$cos|-sinz$sinw$sin|-sinz$coswsinz$sin|-cosz$sinw$cos|sinz$cos|+cosz$sinw$sin|cosz$cosw  Both matrices are orthogonal matrices. Thus its inverse transformation is given by   (CEB)-1=(CEB)T=CBE.  While the aeronautical standards are clearly defined in photogrammetry each system has its own specific definition, e.g. for BLUH and PATB the orientation of the axes of the image coordinate system are shown in Figure 4. Its definitions are different from the body coordinate system used in navigation (see Figure 5).   +x-axis+z-axis+y-axisSystem PATB Figure 4: Definition of the orientation of the image coordinate system for BLUH (left) and PATB (right) +x-axis+y-axis+z-axisSystem BLUH 6  Figure 5: Definition of the body coordinate system used in navigation      After establishing the appropriate matrices either a vector from the image coordinate system into the object coordinate system or vice versa can be transformed by    rB=CEB$rE=(CBE)T$rE  object to image coordinate system (E- to B-system)    rE=CBE$rB=(CEB)-1$rB image to object coordinate system (B- to E-system)  In this notation the vector to be transformed (input) is situated on the right side of the equation and the vector of the target system (output) on the left side. The upper index of the vector on the right must coincide with the lower index of the transformation matrix to be multiplied while its upper index indicates the target system. Note that the indices of the transposed or inverse matrices in brackets are vice versa. This will simplify the following derivations.  If one of the transformation matrices is known the rotation angles (j, w, k) can be recalculated from its matrix elements Cij  for which the definition of the rotation order is essential. The results are shown for the two systems BLUH and PATB in Table 1:  System BLUH System PATB w=arctanC31C33 w=arcsinC13=arctanC13C232+C332 z=arcsin-C32=arctan-C32C122+C222 z=arctan-C23C33 x=arctanC12C22 x=arctan-C12C11 Table 1: Calculation of the rotation angles j, w, k from the matrix elements of the rotation matrix    4 Derivation of the formulas to convert the attitude and heading angles of an INS for direct georeferencing  The subjects of the previous two chapters are focussed on the individual treatment of the rotation and transformation matrices and the corresponding rotation angles used in navigation and in photogrammetry to transform a vector from one system to another system. Table 2 shows a management synopsis of the results.  To convert the attitude and heading angles (f, q, y) of an INS into the photogrammetric angles (j, w, k) the different coordinate systems and rotation angles definitions have to be considered. Furthermore the mapping system used and whether a correction due to earth curvature and meridian deviation has been applied in the photogrammetric system must be considered. For this reason a +x-axis+z-axis+y-axisbody system (b-system) 7 spatial cartesian tangent plane coordinate system is recommended as object coordinate system. The origin of this coordinate system should coincide with the centre of the image block.  Navigation Photogrammetry roll, pitch and heading angles: y, f, q  phi, omega and kappa : j, w, k   vector in body coordinate  system (b-System):  vector in image coordinate system (B-System)  vector in navigation coordinate  system (n-system):  vector in terrain or object  coordinate system (E-system) transformation matrix from  body to navigation system            Cbn=(Cnb)T transformation matrix from terrain to image system               CEB=(CBE)T  vector in earth centred  earth fixed coordinate system (ECEF)   direction of the plumb line  approximated by the ellipsoidal geographic coordinates  transformation matrix from ECEF to navigation system   Cen=(Cne)T  Table 2: Concise overview of the different coordinate systems, vectors, angles and transformations matrices used in navigation and in photogrammetry  Because of the different orientation of the coordinate axes in navigation and in photogrammetry two additional transformation matrices are required to get equivalently orientated systems. These are: 1. matrix to convert a vector from b-System to B-system and vice versa: BbT 2. matrix to convert a vector form n-System to E-System and vice versa : EnT  The matrices consist of the following elements:  System BLUH   System PATB    n-System to E-System        Using these matrices the following four vector transformations can be performed:  Body to image coordinate system (b to B):   rB=TbB$rb Image to body coordinate system (B to b):    rb=TBb$rB=(TbB)T$rB  rb=xbybzbrn=xnynznrB=xByBzBrE=xEyEzEre=XeYeZewkhTbBLUHB=1000-1000-1TbPATBB=-10001000-1TnE=01010000-1 8 Navigation to object coordinate system (n to E):   Object to navigation coordinate system (E to n):   The last mentioned transformation is only valid if a tangent plane coordinate system is used as E-system or if corrections due to earth curvature and meridian deviation are applied in case of Gauß-Krüger-coordinates. Otherwise a further transformation matrix is required to compensate for these effects:   with      k0GK: mean meridian of the Gauß-Krüger-coordinate system  For direct georeferencing the transformation matrix from the image coordinate system (B-system) in which the image coordinates are measured to the terrain system (E-system) (or its inverse matrix) has to be derived for each image from the inertially determined coordinates of the projection centre and the corresponding attitude and headings angles (f, q, y). Then, in the last step, the photogrammetric angles phi, omega and kappa (j, w, k) have to be additionally calculated from the derived matrix.  For each exposure site i the following matrices have to be calculated from the attitude and heading angles (fi, qi, yi), the ellipsoidal geographic coordinates (ji, li) and the ellipsoidal geographic coordinates (j0, l0) of the origin P0 of the tangent plane system:  Cbni=f(vi,hi,yi) Cen0=f(w0,k0)  Ceni=f(wi,ki)   In case of Gauß-Krüger-coordinates an additional matrix is required         Cn0nÂ=f(wi,ki,w0,k0,k0GK) otherwise this matrix has to be replaced by the identity matrix I.  Now the following five transformations can be performed:  1. Cbe=(Ceni)T$Cbni   result: b-system to e-system 2. Cbn0=Cen0$Cbe  result: b-system to n0-system (navigation system in P0)   3. CbnÂ=Cn0nÂ$Cbn0  result: b-system to n-system 4. TnB=TbB$(CbnÂ)T  result: n’-system to B-system  5. CEB=TnB$(TnE)T  result: E-system to B-system  Combining all transformation matrices one gets after some matrix operations:  CEB=TbB$Cn0nÂ$Cen0$(Ceni)T$CbniT$(TnE)T  The photogrammetric rotation angles phi, omega, kappa (j, w, k) have to be calculated as already shown above.    rE=TnE$rnrn=TEn$rE=(TnE)T$rECnnÂ=1ev-ee-ev1enee-en1en=-(ki-k0)$coswee=(wi-w0)ev=(ki-k0GK)$sinw 9 5 Treatment and adjustment of misalignments between INS and camera High accurate applications (better 0.1°) require an special treatment of the misalignments between INS and camera. For such applications the INS should be mounted firmly at the camera. In practice, the ideal case of exactly parallel axes of INS and camera cannot be achieved with the necessary accuracy. Thus the small error angles (misalignments, see Figure 6) have to be calibrated and considered additionally in the transformations.   xbybyb*xb*xbzbb*zybyb*zbb*zezeyexinertialcameraxb*inertialcamerainertialinertialinertialinertialcameracameracameracamera  Figure 6: Misalignments ex, ey, ez between INS and camera  Due to the misalignments the body coordinate system b in which the attitude and heading angles are defined the camera refers to a slightly rotated body coordinate system b*. Normally the misalignments ex, ey, ez around the three axes are small angles (< 3°) and a differential  rotation matrix is sufficient. This differential rotation matrix is additionally used to convert the original transformation matrix Cbn prior to its further use. This is done as follows:   Cb&n=Cbn$Tb&b   with the differential rotation matrix (1)     This leads to the following complete transformation matrix in which the misalignments are included:  CEB=TbB$Cn0nÂ$Cen0$(Ceni)T$Cbni$(Tbb&)TT$(TnE)T  (2)  If the INS is fixed at the camera the misalignments ex, ey, ez should stay constant. In general neither the axes of the INS nor the axes of the camera defined by the fiducial marks can be easily measured with conventional geodetic methods, For this reason the determination of the misalignments is performed with a specific on-the-job-calibration procedure. In this procedure the complete system with camera and INS is put in a test flight over a test area with well surveyed control points. Then in a bundle adjustment for each photo the angles phi, omega and kappa (j, w, k) are determined. These angles and the corresponding angles and positions of the projection centres measured by the INS are used to estimate the misalignments.  The estimation of the misalignments is performed in an adjustment for which the following data of each image are used: Tbb&=1ez-ey-ez1exey-ex1 10 · inertially derived angles: f, q, y · photogrammetric angles determined in the bundle adjustment: j, w, k · three dimensional coordinates of the projection centre (ellipsoidal geographic coordinates j, l, h, geocentric coordinates X, Y, Z, or Gauß-Krüger-coordinates E, N, H)  The  unknown of the adjustment model are formed by the misalignments ex, ey, ez  contained in the misalignment matrix (1). When regarding equation (2) the CEB- matrix on the left side can be computed from the photogrammetrically determined angles. On the right side all matrices with the exception of the misalignment matrix can be derived from the inertially determined data. To apply the adjustment model the matrix containing the misalignments have to be isolated. After some transformations equation (2) can be written as  (TbB)T$CEB=Tbb&$(Cbni)T$Ceni$TnE$Cn0nÂ$Cen0T (3) or abbreviated to B=Tbb&$D      (4)  with B=b11b12b13b21b22b23b31b32b33=(TbB)T$CEB   and D=d11d12d13d21d22d23d31d32d33=(Cbni)T$Ceni$TnE$Cn0nÂ$Cen0T  The reconstruction of equation (4) results in:  b11b12b13b21b22b23b31b32b33=1ez-ey-ez1exey-ex1$d11d12d13d21d22d23d31d32d33  Each matrix element on the left side defines a single equation. Thus the following 9 equations can be formed for each photo i:         or         b11=d11+d21$ez-d31$eyb12=d12+d22$ez-d32$eyb13=d13+d23$ez-d33$eyb21=-d11$ez+d21+d31$exb22=-d12$ez+d22+d32$exb23=-d13$ez+d23+d33$exb31=d11$ey-d21$ex+d31b32=d12$ey-d22$ex+d32b33=d13$ey-d23$ex+d33b11-d11=d21$ez-d31$eyb12-d12=d22$ez-d32$eyb13-d13=d23$ez-d33$eyb21-d21=-d11$ez+d31$exb22-d22=-d12$ez+d32$exb23-d23=-d13$ez+d33$exb31-d31=d11$ey-d21$exb32-d32=d12$ey-d22$exb33-d33=d13$ey-d23$ex 11  The equations on the right are equivalent to the well-known adjustment model when disregarding the vector with the residuals v: li+vi=Ai$x     (5)  with li=b11-d11b12-d12b13-d13b21-d21b22-d22b23-d23b31-d31b32-d32b33-d33 Ai=0-d31d210-d32d220-d33d23d310-d11d320-d12d330-d13-d21d110-d22d120-d23d130  After applying this equation system to each photo the total normal equations including all measurement are established and solved for the misalignments:     n: total number of photos  The standard deviation derived form the residuals in (5) indicates the quality of the adjustment.    6 In situ calibration of the Local Earth Observation system LEO In the last years at the University of Applied Sciences Bochum the Local Earth Observation system LEO has been developed (Bäumker et al. 1998, Bäumker et al. 1999, Bäumker et al. 2000). The most recent development is based on a state-of-the-art strapdown INS (LLN-G1, see Figure 7) equipped with three fibre optical gyros (FOG) and three pendulum accelerometers and a differential single frequency C/A-Code GPS receiver (LEICA 9400) to augment and to improve the inertial measurements providing an accuracy in positioning of appr. 0.30 m in the DGPS mode. The accuracies of the inertial instruments used are described in Table 3. For best accuracy the modified INS (removal of the power supply) is firmly mounted on a digital camera (at present a Kodak DCS 420 or KODAK DCS 460) and controlled by a stabilised platform (see Figure 8) to guarantee perfect photos even under turbulent flight conditions.     Figure 7: Modified inertial navigation system LLN-G1 with fibre optical gyros; at the front: one of the three coils with 500 m fibre length  x=exeyezx=i=1nS(AiT$Ai)-1$ni=1S(AiT$li) 12 Table 3: Accuracies of the inertial sensors  Camera and INS are mounted in such a way that their principal axes are almost parallel. The remaining small angle differences (misalignments) are determined during a special in situ or on-the-job-calibration as already mentioned and will be later additionally considered in the direct georeferencing of the image or scanner data.  Figure 8: Controlled platform with digital camera Kodak DCS 460 (f = 28 mm, 2000 x 3000 pixel) and the FOG-INS LLN-G1 modified (LITEF Germany)   Normally the determination of the misalignments has to be performed with the complete equipment during an extra test flight over an area with sufficient control points. A major disadvantage of this procedure is its dependency from the whether and from the availability of a suited aircraft and test area. For this reason at the University of Applied Sciences Bochum  a special indoor calibration procedure has been developed and already carried out. The procedure enables an on-job-calibration of the misalignments during a simulated flight in the laboratory. The procedure is based on a test field with 40 control points. The three-dimensional test field has been established in the laboratory of the department of civil engineering with a size of appr. 10 m x 6 m (Figure 9).        Figure 9: Laboratory of the department of civil engineering with crane, INS, camera and ground control points  FOG Gyro accelero-meter drift/bias 0.1°/h 0.5 mg scale factor 100 ppm 1000 ppm noise 0.02 °/h 0.01 mg  13 The coordinates of the control points were determined by tachymeter and precise level in system WGS84 (accuracy < 1mm). Additionally signalled points are used as tie points in the bundle block adjustment. The calibration flight took place without the controlled platform in a height of 3.5 m up to 7 m above ground yielding image scales between 1:250 to 1:125. The remotely controlled steering of the crane with its equipment considered an overlap of the images of 60% forward and 40% across.  While in a real flight the images have to be taken during the motion of the aircraft with this procedure the crane can be exactly stopped at the predetermined exposure positions. During this time the INS is switched to the navigation mode on-ground in which a zero velocity update (ZUPT) is performed in the Kalman Filter to estimate the system and sensor errors and to improve the system performance of the INS because in the laboratory no GPS signals are available to augment the system. Thus the INS must operate the other time in the free inertial mode.  Another distinctive feature of the lab calibration is the determination of the initial heading from the earth rate estimations during the two minutes self alignment. In general, the initial heading accuracy depends on the gyro biases and on the amount of the horizontal earth rate component resulting in an initial heading accuracy of 0.5 ° at mid latitudes. During an GPS-augmented flight this accuracy is considerably improved to < 0.05 ° soon after some accelerations and the take off of the aircraft with the help of the GPS measurements used as observations in the Kalman Filter. To achieve the required initial heading accuracy in the lab a special two position alignment is performed in which the gyro and accelerometer biases and the earth rate components can be estimated and separated. After this alignment procedure the accuracy of the attitude angles is < 0.005° and of the heading angle < 0.025°.  During the following lab flight 28 photos were taken, one of them is shown in Figure 10. The image coordinates of the signalled control and tie points (see Figure 11) were automatically measured (coded bar marks) with an accuracy of < 2 mm. The bundle adjustment provides for each image  the photogrammetric angles (j, w, k) which are fed together with the inertially derived quantities into the above described adjustment model. Table 3 is showing in extracts the coordinates of the projection centres (north, east, height) and the roll, pitch and heading angles (f, q, y) determined by the INS. The adjusted misalignments (ex, ey, ez) and the residuals of the adjustment are listed together with the photogrammetric determined angles (j, w, k) in Table 4. From the residuals a standard deviation of 0.003° Gon for j, w and of 0.011° Gon for k have been estimated.  Figure 10 (left): Photo taken at the lab test flight   Figure 11 (below): Signalled ground  control point (coded bar mark for auto-matic measurement of image coordinates)   14 The results show the powerful capability of the lab calibration method to determine the misalignments between camera and INS to be used for direct georeferencing. There is no need for an expensive calibration flight over a test field with well surveyed control points and nevertheless the system is calibrated in situ.    Point Northing [m]   Easting[m]   height [m]  Roll[°]  Pitch[°]   Head[°]   0 5700085.0      2580116.0     107.0       (origin of the test field) 101 5700088.2209   2580117.1066  107.2483   -1.45     -0.32     -28.68 102 5700087.7932   2580117.8857  107.2492   -1.45     -0.29     -28.81 103 5700087.3698   2580118.6747  107.2496   -1.45     -0.29     -29.08 104 5700086.9704   2580119.4247  107.2512   -1.45     -0.27     -28.99 .... 401 5700082.0422   2580119.2659  107.2381   -1.37     -0.71     -28.43 402 5700082.9423   2580119.7544  107.2400   -1.45     -0.57     -28.47 403 5700083.9653   2580120.3192  107.2447   -1.55     -0.45     -28.56 404 5700084.8925   2580120.8238  107.2474   -1.39     -0.44     -28.55 405 5700085.9316   2580121.3922  107.2486   -1.43     -0.49     -29.16 Table 4: Coordinates of the projection centres and roll, pitch and heading angles (f, q, y) of the INS (in extracts)     adjusted misalignments: ex = 0.2126°, ey = 0.3138°, ez = 0.0989°   Point  j [Gon]   w [Gon]   k [Gon]   dj [Gon]  dw [Gon]   dk [Gon]    101   -1.2100    0.6500  131.7700   -0.0005   -0.0038    0.0117   102   -1.1900    0.6900  131.9000    0.0020    0.0043   -0.0022   103   -1.1900    0.6900  132.2000   -0.0013   -0.0013   -0.0022   104   -1.1800    0.7100  132.1000   -0.0010    0.0011   -0.0018   ....   401   -1.3400    0.2300  131.5000    0.0004    0.0048    0.0117   402   -1.3400    0.4100  131.5100    0.0043    0.0048   -0.0199   403   -1.3800    0.5800  131.6300   -0.0025    0.0025    0.0027   404   -1.2200    0.5000  131.6100   -0.0039   -0.0021   -0.0063   405   -1.2800    0.4900  132.2800   -0.0034    0.0019   -0.0149  Std.dev. (Phi,Omega,Kappa) [Gon]:     0.0026    0.0030    0.0107  Table 5: Adjusted misalignments, photogrammetric angles (j, w, k) and their residuals (in extracts)    7 Results of direct georeferencing After completion of the system’s laboratory calibration as described above a test flight over the test area of the University of Applied Sciences Bochum has been carried out to evaluate the performance of direct georeferencing. The flight parameters have been as follows:   · camera: Kodak DCS 460 CIR (appr. 2000 x 3000 pixel) · image size:   18,4 mm x 27,6 mm  · focal length: 28 mm · image scale: 1 : 25.000 · forward overlap: 60 %  · sidelap: 25 %, four flight lines  · base to height ratio: 0,25  · flight height: 700 m  · total number of images: 70  15  First of all a reference bundle adjustment has been carried out to determine the coordinates of appr. 500 tie points. These tie points (standard deviation in planimetric coordinates appr. 0.25 m, in height appr.  1.0 m) were used as check points in the investigations of the accuracy performance of direct georeferencing.  With the elements of exterior orientation as determined in-flight (angles already corrected for misalignments) forward intersections were carried out with the image coordinates measured – an independent direct georeferencing. From the comparison of both sets of coordinates the following standard deviations were obtained:                       ssX = 0,30 m; ssY = 0,43 m; ssZ = 1,50 m  It should be mentioned that the calculated standard deviations contain the uncertainties of the bundle adjustment and those of the direct georeferencing.      8 Practical Conclusions In recent years the aerial survey system LEO (Local Earth Observation)  for direct georeferencing of image data has been developed at the University of Applied Sciences Bochum. In the latest stage of development the system is based on a highly dynamic stabilising platform on which the digital camera (Kodak DCS 460) as well as the inertial system (state-of-the-art fibre optical gyros (FOG) and pendulum accelerometers) are mounted.  For direct georeferencing of image data the angles roll, pitch and heading (f, q, y) determined in-flight by the inertial system have to be transformed into the angles omega, phi and kappa (j, f, k) of the photogrammetric system used. The transformations additionally have to consider that the image coordinate systems as well as the object coordinate systems in photogrammetry are defined in different ways. In any case the misalignments  (non-parallelism) between the principal axes of  the camera system and the inertial system have to be corrected for. In general the misalignments are determined from a special calibration flight over a test field with a sufficient number of ground control points.     To avoid extra effort and cost a calibration procedure has been developed which provides the misalignment values from laboratory calibration and which is also independent from weather conditions. The laboratory calibration procedure is based on a three-dimensional test field with 40 ground control points. The calibration flight is performed with the help of a remotely controlled travelling crane on which the complete system (camera and inertial system) is mounted in situ. The adjustment for the determination of the calibration data as well as the transformation of the angles is carried out according to mathematically rigorous algorithms. These algorithms can be easily adapted to other photogrammetric coordinate systems.  Due to the lack of GPS measurements in the laboratory a special heading alignment procedure is applied to estimate initial heading and the biases of the inertial sensors. Photos are taken whilst the travelling crane stops. During this time period the inertial system changes into the on ground mode in which the system is continuously improved by zero velocity updates (ZUPTs) performed in the Kalman Filter.  The results demonstrate that with the procedure described an accuracy of 0.003 Gon for omega and phi and of 0.011 Gon for kappa is obtainable after calibration of the misalignments. Herewith an efficient procedure is available for the calibration of the misalignments between inertial system and camera and for the transformation of the inertial angles into the photogrammetric system. Besides the  16 angles omega, phi and kappa the system delivers positional data with an accuracy of 0.3 m (horizontal) resp. 1.5 m (vertical) for direct georeferencing of all kinds of image or scanner data.    References   Airlines Electronic Engineering Committe (1982): ARINC Characteristic 705 - Attitude and Heading Reference System. Aeronautical Radio INC., Annapolis, Maryland 1982. Bäumker, M. (1995): Basiswissen Inertial- und Sensortechnik. In: Journal for Satellite-Based Positioning, Navigation and Communication, Vol. 4/95, pp. 147-152, December 1995. Bäumker, M., R. Brechtken, F.-J. Heimes, T. Richter (1998): Hochgenaue Stabilisierung einer Sensorplattform mit den Daten eines (D)GPS-gestützten Inertialsystems. Zeitschrift für Photogrammetrie und Fernerkundung ZPF, Heft 1/98, S. 15-22. Bäumker, M., R. Brechtken, F.-J. Heimes, T. Richter (1999): Direkte Georeferenzierung mit dem Luftaufnahmesystem LEO. In: Proceedings 10. Internationale Geodätische Woche, Obergurgl, 21.2.-27.2.1999. Bäumker, M., F.-J. Heimes, H. Hahn, W. Klier, R. Brechtken, T. Richter (2000): Mathematical Modeling, Computer Simulation, Control and Applications of a Stabilized Platform of an Airborne Sensor. In: Proceedings ISPRS 2000 Amsterdam, Volume XXXIII, Part B2, pp. 278-286, Amsterdam, The Netherlands, 16 -23 July 2000. Cramer, M. (1999): Direct Geocoding - Is Aerial Triangulation Obsolete? In: Photogrammetric Week ‘99 Stuttgart, S. 59 - 70. H. Wichmann Verlag Heidelberg 1999. Hutton, J. und E. Lithopoulus (1998): Airborne Photogrammetry Using Direct Camera Orientation Measurements. In: Photogrammetrie - Fernerkundung - Geoinformation 6/1998, pp. 363-370, 1998. INPHO GmbH (1999): FAQ - PATB-GPS. In: Firmen Website unter http://www.inpho.de (1999). Jacobsen, K. (1996): User Manual Programm System BLUH. Institute for Photogrammetrie and Engineering Surveys, University Hannover, 1996. Kraus, K. (1997a): Photogrammetrie, Band 1: Grundlagen und Standardverfahren. 6. Aufl., Dümmlers Verlag, ISBN: 3-427-78646-3, 1997. Kraus, K. (1997b): Photogrammetry, Vol. 2: Advanced Methods and Applications. 4th ed., Dümmlers Verlag, ISBN: 3-427-78694-3, 1997. Schwarz, K.P. (1995): Integrated airborne navigation system for photogrammetry. In Photogrammetric Week 1995, pp. 139-154, Wichmann Verlag Heidelberg 1995.  Addresses of the  authors:                Prof. Dr.-Ing. F.-J. Heimes University of Applied Sciences Bochum Department of Surveying and Geoinformatics Lennershofstr. 140 D-44801 Bochum e-Mail: Franz-Josef.Heimes@FH-Bochum.de Prof. Dr.-Ing. M. Bäumker University of Applied Sciences Bochum Department of Surveying and Geoinformatics  Lennershofstr. 140 D-44801 Bochum e-Mail: Manfred.Baeumker@FH-Bochum.de  17   